# 围绕宝塔面板开展的WP环境调优细节指南

此文受Miss之托才会出现在你们的视野中！

无作者Element授权，请勿转载！

遵循 AGPL-3.0 协议 原文地址为：[文章/围绕宝塔面板开展的WP环境调优细节指南.md · 元素/webBack - 码云 - 开源中国 (gitee.com)](https://gitee.com/elementxuan/web-back/blob/master/文章/围绕宝塔面板开展的WP环境调优细节指南.md)


# 1.我的主要需求以及环境选择

## 1.1我的需求
在选购服务器之时，就需要对即将运行的业务流有一个初步的构思，并根据此业务流进行一些适当的资源配比以及带宽量计算的构思。

下面的以我的实例举个例子：

我需要搭建两个WP网站和一个文档网站，WP没有选择的余地都是以伪静态规则的方式部署，而文档网站我的设计构思是单html页面所以暂且抛开不谈。

单个WP的源程序在15M左右，所以最最局限我们的磁盘空间要保留100M给WP，因为随着时间的流逝，文章数量会逐渐增加，数据库也会变大，在平常编写文档时WP会自动保存你的编辑文件，安装卸载的插件都会在你的数据库中留下它曾经的印记，如果你不去关注它 那么小恶魔也会慢慢成长哦！

但是真正吃空间的其实是围绕WP所需要的环境（Nginx  Mysql  php  Redis*），本次主要要聊的就是关于配置环境的优化策略，所以我们要花费较大的篇幅先让朋友们了解一下他们的作用。

注：Redis不是环境，但大部分朋友不管是否懂 都会安装。

Nginx：一个轻量级、高性能、稳定性高、并发性好的HTTP和反向代理服务器。其真正的优势我认为是负载均衡和反向代理。

Mysql：一种性能较高，开源的关系型数据库，在此补充一个知识点 开源≠免费。数据库如何理解呢？我们理解为一个网站就是我们经营的一家鞋店，当有顾客光临时，我们需要从仓库拿出来，简化来说就是鞋子入库出库行为，但我们现在经营的是一家Web网站，所以我们需要操作入库出库的对象是数据，那么数据库顾名思义就是存放数据的仓库啦！

php：是一款易于上手的服务端脚本语言，它只在服务器上执行。我对该 “世界上最好的语言” 不太感冒，虽然8.0以及之后的版本进步喜欢，但是失去的市场就是失去了很难再挽回。

## 1.2我的配置选择
我使用的是一款 2核心 4G内存 6M宽带 50G固态的云服务器，最让我惊喜的是其居然赠送100G的ddos 月/次，爽！

这一小节给大家划重点的其实是 如何选择合适你的带宽！

服务器带宽一般分为上行带宽，下行带宽，公网带宽，内网带宽：

- 上行带宽(在购买服务器时标注的参数)：是指服务器传输给客户端的带宽。 如从服务器下载文件，消耗的是服务器的上行带宽。 
- 下行带宽(通常不限)：是指客户端上传文件到服务器，消耗的是服务器的下行带宽。 
- 公网带宽：通过公网ip产生的流量所占带宽。 
- 内网带宽：多台服务器处于同一网段，通过内网ip产生的流量所占带宽。

也许有朋友会说：这我知道啊！越大越好呗！我： 汗颜“富哥，我们交个朋友吧！” 要知道带宽是服务器费用占用中大头呀！<

闲话少叙，服务器一般标注的单位是Mbps，例如1Mbps常称之为1M带宽。需要注意的是，1Mbps带宽并不表示每秒的速度可达1M，1Mbps带宽的最大速度为128kb每秒，2Mbps的速度则为256kb每秒，依此类推。

我们需要掐算单页面需要请求多少资源，又有多少人同时发起请求。

ex：e-yuansu.com的某个页面大小是 100k，有1位客户在1秒中打开了这个页面，我们的云服务器1M宽带理论最大速度是128kb。

此公式为：1位客户*1个页面=1 * 100= 100kb，那么我们1M目前能吼得住。

ok 现在又来人了哦！  他们很巧合的在同一秒访问这个100k的页面，此时计算公式为：

2位客户*2个页面 = 2*200 = 400kb，现在我们的1M宽带就吼不住啦 一位客户需要花费2秒才能访问你的网页。

睡觉明天又会  有缘在更！

系统版本：OpenCloudOS 9

PHP：7.4.33

